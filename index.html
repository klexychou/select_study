<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <title>ç§‘å­¸ç­ç”Ÿç”¢åŠ›è¨ˆç•«</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#121212">
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100' style='background-color: %232c3e50'%3E%3Crect width='100' height='100' fill='%232c3e50'/%3E%3Ctext y='50%25' x='50%25' dominant-baseline='central' text-anchor='middle' font-size='60' %3Eâš›ï¸%3C/text%3E%3C/svg%3E">

    <style>
        /* --- 1. æ ¸å¿ƒä½ˆå±€ä¿®æ­£ (iPhone 13 é©é…) --- */
        body {
            font-family: "Microsoft JhengHei", -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: #0d1117; /* GitHub Dark èƒŒæ™¯è‰² */
            color: #c9d1d9;
            margin: 0;
            /* é—œéµï¼šä½¿ç”¨ dvh è§£æ±º iOS Safari ç¶²å€åˆ—é®æ“‹å•é¡Œ */
            height: 100vh; 
            height: 100dvh; 
            overflow: hidden;
            display: flex;
            flex-direction: column;
            /* é¿é–‹ç€æµ·èˆ‡åº•éƒ¨æ©«æ¢ */
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
        }

        .hidden { display: none !important; }

        button {
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.1s;
            -webkit-tap-highlight-color: transparent;
            font-family: inherit;
        }
        button:active { transform: scale(0.96); }

        /* --- æ¨™é¡Œåˆ— (å›ºå®šé«˜åº¦) --- */
        .header-nav {
            height: 50px;
            padding: 0 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #161b22;
            border-bottom: 1px solid #30363d;
            flex-shrink: 0; /* ç¦æ­¢å£“ç¸® */
        }
        h2 { margin: 0; color: #58a6ff; font-size: 18px; }
        .icon-btn {
            background: #21262d;
            font-size: 12px;
            padding: 6px 12px;
            color: #c9d1d9;
            border: 1px solid #30363d;
        }

        /* --- ä¸»ç•«é¢å®¹å™¨ --- */
        #setup-screen, #draw-screen, #stats-screen {
            flex: 1; /* ä½”æ»¿å‰©é¤˜ç©ºé–“ */
            display: flex;
            flex-direction: column;
            overflow: hidden; /* é˜²æ­¢æ•´é«”æº¢å‡º */
            position: relative;
        }

        /* --- åˆ—è¡¨å€åŸŸ (å¯æ»¾å‹•) --- */
        .list-container {
            flex: 1; /* è‡ªå‹•å¡«æ»¿ä¸­é–“å€åŸŸ */
            overflow-y: auto; /* åªæœ‰é€™è£¡å¯ä»¥æ»¾å‹• */
            padding: 10px 15px;
        }

        /* --- åº•éƒ¨æŒ‰éˆ•å€ (å›ºå®šé«˜åº¦) --- */
        .bottom-actions {
            padding: 15px;
            background: #161b22; /* åº•éƒ¨èƒŒæ™¯ï¼Œé¿å…é€æ˜ */
            border-top: 1px solid #30363d;
            display: flex;
            flex-direction: column;
            gap: 10px;
            flex-shrink: 0; /* ç¦æ­¢å£“ç¸® */
        }

        /* --- ç§‘ç›®åˆ—è¡¨æ¨£å¼ --- */
        .subject-row {
            display: flex;
            align-items: center;
            background-color: #161b22;
            margin-bottom: 8px;
            padding: 8px 12px;
            border-radius: 6px;
            border: 1px solid #30363d;
        }
        
        /* æ’åºæŒ‰éˆ• */
        .order-btns {
            display: flex;
            flex-direction: column;
            margin-right: 8px;
        }
        .order-btn {
            background: none;
            color: #8b949e;
            font-size: 10px;
            padding: 0;
            line-height: 1;
            height: 12px;
            margin: 2px 0;
        }

        input[type="checkbox"].sub-check {
            transform: scale(1.3);
            margin-right: 12px;
            accent-color: #58a6ff; 
        }

        .subject-name { flex: 1; font-size: 16px; color: #e6edf3; }
        
        .custom-name-input {
            flex: 1;
            background: transparent;
            border: none;
            border-bottom: 1px dashed #30363d;
            color: #3fb950;
            font-size: 16px;
            padding: 2px 0;
            width: 100%;
        }
        .custom-name-input:focus { outline: none; border-bottom: 1px solid #3fb950; }

        .weight-input {
            width: 30px;
            height: 28px;
            text-align: center;
            font-size: 16px;
            background-color: #0d1117;
            color: #c9d1d9;
            border: 1px solid #30363d;
            border-radius: 4px;
            margin-left: 8px;
        }

        .start-btn {
            padding: 15px;
            background: #238636; /* GitHub Green */
            color: white;
            font-size: 18px;
            width: 100%;
        }

        /* å‚™ä»½æŒ‰éˆ• */
        .backup-area { display: flex; gap: 10px; }
        .backup-btn {
            flex: 1;
            padding: 8px;
            background: #21262d;
            color: #8b949e;
            font-size: 12px;
            border: 1px solid #30363d;
        }

        /* --- æŠ½ç±¤èˆ‡ç•ªèŒ„é˜é é¢ --- */
        #draw-screen {
            justify-content: center;
            align-items: center;
            background: radial-gradient(circle at center, #1f242d 0%, #0d1117 100%);
        }

        #result-area { text-align: center; margin-bottom: 30px; }
        #result-display {
            font-size: 50px;
            font-weight: bold;
            color: #58a6ff;
            margin: 10px 0;
            text-shadow: 0 0 20px rgba(88, 166, 255, 0.4);
        }
        
        /* ç•ªèŒ„é˜æ¨£å¼ */
        .timer-container {
            text-align: center;
            padding: 20px;
            background: #161b22;
            border-radius: 16px;
            border: 1px solid #30363d;
            margin-bottom: 30px;
            width: 80%;
        }
        #timer-display {
            font-size: 60px;
            font-family: monospace;
            color: #e6edf3;
            font-weight: bold;
        }
        .timer-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }
        .timer-btn {
            padding: 10px 20px;
            font-size: 16px;
            background: #21262d;
            color: #c9d1d9;
            border: 1px solid #30363d;
        }
        .timer-btn.active { background: #d29922; color: #fff; border:none; }

        .action-btn {
            padding: 15px 60px;
            font-size: 20px;
            background: #1f6feb;
            color: white;
            border-radius: 50px;
            box-shadow: 0 0 15px rgba(31, 111, 235, 0.3);
            margin-bottom: 20px;
        }
        .back-btn { background: transparent; color: #8b949e; font-size: 14px; margin-top: 10px; }

        /* --- çµ±è¨ˆé é¢ (ç†±åŠ›åœ–) --- */
        .heatmap-container {
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .heatmap-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr); /* 7å¤©ä¸€åˆ— */
            gap: 4px;
            margin-bottom: 10px;
        }
        .day-sq {
            width: 15px;
            height: 15px;
            border-radius: 2px;
            background-color: #161b22;
            border: 1px solid #30363d;
        }
        /* GitHub è²¢ç»åº¦é¡è‰² */
        .l0 { background-color: #161b22; }
        .l1 { background-color: #0e4429; }
        .l2 { background-color: #006d32; }
        .l3 { background-color: #26a641; }
        .l4 { background-color: #39d353; }
        
        .chart-scroll {
            flex: 1;
            width: 100%;
            overflow-x: auto;
            padding-bottom: 20px;
        }
    </style>
</head>
<body>

    <div id="setup-screen">
        <div class="header-nav">
            <h2>è®€æ›¸è¨ˆç•« V7</h2>
            <button class="icon-btn" onclick="showStats()">ğŸ“Š ç†±åŠ›åœ–</button>
        </div>
        
        <div class="list-container" id="subject-list"></div>
        
        <div class="bottom-actions">
            <div style="display:flex; justify-content:space-between; align-items:center; padding:0 5px;">
                <span style="font-size:12px;
